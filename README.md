# XrayTalbotInterferometry_Levenberg_Marquardt_SinusFit
I post here the software for calculation X-ray Talbot Interferometric data using sinus fitting in C++.

This program calculates differential phase image, visibility image and absorption image measured by fringe-scanning technique using X-ray Talbot Interferometry or X-ray grating interferometry. In the zip folder <dph_abs_vis_images_calc_Momose_approach_data.zip>, are 5 foregroung (fg) images and 5 background (bg) images. The number 5 means that position of amplitude grating was changed in 5 steps. In each pixel, the 5 intensity values for 5 foreground and 5 background images lies on the sinus curve. The Levenberg-Marquardt algorithm for fitting sinusoidal function is used to fit this sinus curve for foreground and background data. the results of fitting is amplitude value, phase value and offset value for each pixel. From these fitting values, the differential phase, visibility and absorption images are calculated.

The sinusiodal function is one of the basic non-linear functions. The sinusoidal function is frequently used in optics in interferometry or electronics. To know the low-level algorithm for fitting sinusoidal function can be very useful in X-ray Talbot interferometry or grating interferometry. Here, I post Levenbergâ€“Marquardt algorithm for fitting simple sinusoidal function. The C++ function <levmar_sinus> in posted algorithm is doing that. The study material and detail explanation of algorithm is posted by Technical University of Denmark by Madsen, Nielsen and Tingleff on the web-page <http://www2.imm.dtu.dk/pubdb/edoc/imm3215.pdf>. The presented algorithm fits amplitude, phase and offset of sinusoidal function. 

The Levenberg-Marquardt algorith posted here is using Eigen C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms. The only problem with my algorithm is that calculation of single image takes ages, 2.5 hour on the Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz 2.20 GHz processor. Maybe, my implementation is not the fastest, but you can experiment with my algorithm and improve it by yourself. 
